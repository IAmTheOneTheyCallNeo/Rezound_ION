--- arch/arm/mach-msm/htc_battery_8x60.c	2013-04-20 02:33:28.183486808 -0700
+++ arch/arm/mach-msm/htc_battery_8x60.c	2013-04-20 02:30:35.373042910 -0700
@@ -37,8 +37,10 @@
 #include <linux/android_alarm.h>
 #include <linux/suspend.h>
 #include <linux/earlysuspend.h>
+#include <mach/rpm.h>
 
 #define BATT_SUSPEND_CHECK_TIME			3600
+#define BATT_SUSPEND_HIGHFREQ_CHECK_TIME	(300)
 #define BATT_TIMER_CHECK_TIME			360
 
 #ifdef CONFIG_HTC_BATT_ALARM
@@ -213,19 +215,20 @@
 		BATT_ERR("%s:Warning:set mode to %d from non-disable mode(%d)",
 			__func__, mode, battery_vol_alarm_mode); */
 	switch (mode) {
-	case BATT_ALARM_DISABLE_MODE:
-		rc = batt_clear_voltage_alarm();
-	break;
-	case BATT_ALARM_CRITICAL_MODE:
-		rc = batt_set_voltage_alarm(BATT_CRITICAL_LOW_VOLTAGE,
-			alarm_data.upper_threshold);
-	break;
-	default:
-	case BATT_ALARM_NORMAL_MODE:
-		rc = batt_set_voltage_alarm(alarm_data.lower_threshold,
-			alarm_data.upper_threshold);
-	break;
+		case BATT_ALARM_DISABLE_MODE:
+			rc = batt_clear_voltage_alarm();
+			break;
+		case BATT_ALARM_CRITICAL_MODE:
+			rc = batt_set_voltage_alarm(BATT_CRITICAL_LOW_VOLTAGE,
+				alarm_data.upper_threshold);
+			break;
+		default:
+		case BATT_ALARM_NORMAL_MODE:
+			rc = batt_set_voltage_alarm(alarm_data.lower_threshold,
+				alarm_data.upper_threshold);
+			break;
 	}
+
 	if (!rc)
 		battery_vol_alarm_mode = mode;
 	else {
